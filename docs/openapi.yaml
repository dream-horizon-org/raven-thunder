openapi: 3.1.0
components:
  schemas:
    BehaviourTag:
      type: object
      properties:
        name:
          type: string
        description:
          type: string
        createdAt:
          type: integer
          format: int64
        createdBy:
          type: string
        lastUpdatedAt:
          type: integer
          format: int64
        lastUpdatedBy:
          type: string
        exposureRule:
          $ref: '#/components/schemas/ExposureRule'
        ctaRelation:
          $ref: '#/components/schemas/CTARelation'
        linkedCtas:
          type: array
          uniqueItems: true
          items:
            type: string
        tenantId:
          type: string
    BehaviourTagCreateRequest:
      type: object
      properties:
        behaviourTagName:
          type: string
        description:
          type: string
        exposureRule:
          $ref: '#/components/schemas/ExposureRule'
        ctaRelation:
          $ref: '#/components/schemas/CTARelation'
        linkedCtas:
          type: array
          uniqueItems: true
          items:
            type: string
    BehaviourTagPutRequest:
      type: object
      properties:
        description:
          type: string
        exposureRule:
          $ref: '#/components/schemas/ExposureRule'
        ctaRelation:
          $ref: '#/components/schemas/CTARelation'
        linkedCtas:
          type: array
          uniqueItems: true
          items:
            type: string
    BehaviourTagsResponse:
      type: object
      properties:
        behaviourTags:
          type: array
          items:
            $ref: '#/components/schemas/BehaviourTag'
    CTA:
      type: object
      required:
      - id
      properties:
        id:
          type: integer
          format: int64
        rule:
          $ref: '#/components/schemas/Rule'
        ctaStatus:
          $ref: '#/components/schemas/CTAStatus'
        name:
          type: string
        description:
          type: string
        tags:
          type: array
          items:
            type: string
        team:
          type: string
        behaviourTags:
          type: array
          items:
            type: string
        startTime:
          type: integer
          format: int64
        endTime:
          type: integer
          format: int64
        createdAt:
          type: integer
          format: int64
        createdBy:
          type: string
        lastUpdatedAt:
          type: integer
          format: int64
        lastUpdatedBy:
          type: string
        tenantId:
          type: string
    CTAListResponse:
      type: object
      properties:
        ctas:
          type: array
          items:
            $ref: '#/components/schemas/CTA'
        totalEntries:
          type: integer
          format: int32
        totalPages:
          type: integer
          format: int32
        pageNumber:
          type: integer
          format: int32
        pageSize:
          type: integer
          format: int32
        statusWiseCount:
          $ref: '#/components/schemas/StatusWiseCount'
    CTARelation:
      type: object
      properties:
        shownCta:
          $ref: '#/components/schemas/CtaRelationRule'
        hideCta:
          $ref: '#/components/schemas/CtaRelationRule'
    CTARequest:
      type: object
      properties:
        name:
          type: string
        tags:
          type: array
          items:
            type: string
        description:
          type: string
        team:
          type: string
        startTime:
          type: integer
          format: int64
        endTime:
          type: integer
          format: int64
        rule:
          $ref: '#/components/schemas/RuleRequest'
    CTAStatus:
      type: string
      enum:
      - DRAFT
      - SCHEDULED
      - LIVE
      - PAUSED
      - CONCLUDED
      - TERMINATED
    CTAUpdateRequest:
      type: object
      properties:
        tags:
          type: array
          items:
            type: string
        description:
          type: string
        team:
          type: string
        startTime:
          type: integer
          format: int64
        endTime:
          type: integer
          format: int64
        rule:
          $ref: '#/components/schemas/RuleRequest'
    CohortEligibility:
      type: object
      required:
      - includes
      - excludes
      properties:
        includes:
          type: array
          items:
            type: string
          minItems: 1
        excludes:
          type: array
          items:
            type: string
    CtaRelationRule:
      type: object
      properties:
        rule:
          $ref: '#/components/schemas/CtaRelationRuleTypes'
        ctaList:
          type: array
          uniqueItems: true
          items:
            type: string
    CtaRelationRuleTypes:
      type: string
      enum:
      - ANY
      - LIST
      - REST
    ExposureRule:
      type: object
      properties:
        session:
          $ref: '#/components/schemas/SessionFrequency'
        window:
          $ref: '#/components/schemas/WindowFrequency'
        lifespan:
          $ref: '#/components/schemas/LifespanFrequency'
    FilterResponse:
      type: object
      properties:
        names:
          type: array
          items:
            type: string
        tags:
          type: array
          items:
            type: string
        teams:
          type: array
          items:
            type: string
        createdBy:
          type: array
          items:
            type: string
    Filters:
      type: object
      required:
      - operator
      - filter
      properties:
        operator:
          type: string
        filter:
          type: array
          items: {}
    Frequency:
      type: object
      properties:
        session:
          $ref: '#/components/schemas/SessionFrequency'
        window:
          $ref: '#/components/schemas/WindowFrequency'
        lifeSpan:
          $ref: '#/components/schemas/LifespanFrequency'
    GroupByConfig:
      type: object
      properties:
        maxActiveStateMachineCount:
          type: integer
          format: int32
        groupByKeys:
          type: array
          items:
            type: string
    JsonObject:
      type: array
      items: {}
    LifespanFrequency:
      type: object
      required:
      - limit
      properties:
        limit:
          type: integer
          format: int32
    Nudge:
      type: object
      required:
      - id
      properties:
        id:
          type: string
        property:
          type: object
          additionalProperties: {}
    NudgePreview:
      type: object
      properties:
        id:
          type: string
        template:
          type: string
        tenantId:
          type: string
        ttl:
          type: integer
          format: int32
    ResponseBehaviourTag:
      type: object
      properties:
        success:
          type: boolean
        data:
          $ref: '#/components/schemas/BehaviourTag'
        error:
          type: string
        message:
          type: string
        statusCode:
          type: integer
          format: int32
    ResponseBehaviourTagsResponse:
      type: object
      properties:
        success:
          type: boolean
        data:
          $ref: '#/components/schemas/BehaviourTagsResponse'
        error:
          type: string
        message:
          type: string
        statusCode:
          type: integer
          format: int32
    ResponseCTA:
      type: object
      properties:
        success:
          type: boolean
        data:
          $ref: '#/components/schemas/CTA'
        error:
          type: string
        message:
          type: string
        statusCode:
          type: integer
          format: int32
    ResponseCTAListResponse:
      type: object
      properties:
        success:
          type: boolean
        data:
          $ref: '#/components/schemas/CTAListResponse'
        error:
          type: string
        message:
          type: string
        statusCode:
          type: integer
          format: int32
    ResponseFilterResponse:
      type: object
      properties:
        success:
          type: boolean
        data:
          $ref: '#/components/schemas/FilterResponse'
        error:
          type: string
        message:
          type: string
        statusCode:
          type: integer
          format: int32
    ResponseLong:
      type: object
      properties:
        success:
          type: boolean
        data:
          type: integer
          format: int64
        error:
          type: string
        message:
          type: string
        statusCode:
          type: integer
          format: int32
    ResponseNudgePreview:
      type: object
      properties:
        success:
          type: boolean
        data:
          $ref: '#/components/schemas/NudgePreview'
        error:
          type: string
        message:
          type: string
        statusCode:
          type: integer
          format: int32
    ResponseObject:
      type: object
      properties:
        success:
          type: boolean
        data: {}
        error:
          type: string
        message:
          type: string
        statusCode:
          type: integer
          format: int32
    Rule:
      type: object
      required:
      - cohortEligibility
      - stateToAction
      - stateTransition
      - priority
      - actions
      - frequency
      properties:
        cohortEligibility:
          $ref: '#/components/schemas/CohortEligibility'
        stateToAction:
          type: object
          additionalProperties:
            type: string
          minProperties: 1
        resetStates:
          type: array
          items:
            type: string
        resetCTAonFirstLaunch:
          type: boolean
        contextParams:
          type: array
          items:
            type: string
        stateTransition:
          type: object
          additionalProperties:
            type: object
            additionalProperties:
              type: array
              items:
                $ref: '#/components/schemas/StateTransitionCondition'
        groupByConfig:
          $ref: '#/components/schemas/GroupByConfig'
        priority:
          type: integer
          format: int32
        stateMachineTTL:
          type: integer
          format: int64
        ctaValidTill:
          type: integer
          format: int64
        actions:
          type: array
          items:
            type: object
            additionalProperties: {}
        frequency:
          $ref: '#/components/schemas/Frequency'
    RuleRequest:
      type: object
      required:
      - cohortEligibility
      - stateToAction
      - stateTransition
      - priority
      - stateMachineTTL
      - actions
      - frequency
      properties:
        cohortEligibility:
          $ref: '#/components/schemas/CohortEligibility'
        stateToAction:
          type: object
          additionalProperties:
            type: string
          minProperties: 1
        resetStates:
          type: array
          items:
            type: string
        resetCTAonFirstLaunch:
          type: boolean
        contextParams:
          type: array
          items:
            type: string
        stateTransition:
          type: object
          additionalProperties:
            type: object
            additionalProperties:
              type: array
              items:
                $ref: '#/components/schemas/StateTransitionCondition'
        groupByConfig:
          $ref: '#/components/schemas/GroupByConfig'
        priority:
          type: integer
          format: int32
        stateMachineTTL:
          type: integer
          format: int64
        actions:
          type: array
          items:
            type: object
            additionalProperties: {}
        frequency:
          $ref: '#/components/schemas/Frequency'
    SessionFrequency:
      type: object
      required:
      - limit
      properties:
        limit:
          type: integer
          format: int32
    StateTransitionCondition:
      type: object
      required:
      - transitionTo
      - filters
      properties:
        transitionTo:
          type: string
        filters:
          $ref: '#/components/schemas/Filters'
    StatusWiseCount:
      type: object
      properties:
        draft:
          type: object
        paused:
          type: object
        live:
          type: object
        scheduled:
          type: object
        concluded:
          type: object
        terminated:
          type: object
    WindowFrequency:
      type: object
      required:
      - limit
      - unit
      - value
      properties:
        limit:
          type: integer
          format: int32
        unit:
          $ref: '#/components/schemas/WindowFrequencyUnit'
        value:
          type: integer
          format: int32
    WindowFrequencyUnit:
      type: string
      enum:
      - days
      - hours
      - minutes
      - seconds
paths:
  /healthcheck:
    get:
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/JsonObject'
  /healthcheck/ping:
    get:
      responses:
        '200':
          description: OK
          content:
            text/plain:
              schema:
                type: string
  /openapi:
    get:
      responses:
        '200':
          description: OK
  /openapi.{type}:
    get:
      parameters:
      - name: type
        in: path
        required: true
        schema:
          type: string
          pattern: json|yaml
      responses:
        '200':
          description: OK
  /thunder/behaviour-tags:
    get:
      parameters:
      - name: x-tenant-id
        in: header
        schema:
          type: string
          default: default
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ResponseBehaviourTagsResponse'
    post:
      parameters:
      - name: user
        in: header
        schema:
          type: string
        required: true
      - name: x-tenant-id
        in: header
        schema:
          type: string
          default: default
      requestBody:
        content:
          '*/*':
            schema:
              $ref: '#/components/schemas/BehaviourTagCreateRequest'
        required: true
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ResponseObject'
  /thunder/behaviour-tags/{behaviourTagName}:
    put:
      parameters:
      - name: behaviourTagName
        in: path
        required: true
        schema:
          type: string
      - name: user
        in: header
        schema:
          type: string
        required: true
      - name: x-tenant-id
        in: header
        schema:
          type: string
          default: default
      requestBody:
        content:
          '*/*':
            schema:
              $ref: '#/components/schemas/BehaviourTagPutRequest'
        required: true
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ResponseObject'
    get:
      parameters:
      - name: behaviourTagName
        in: path
        required: true
        schema:
          type: string
      - name: x-tenant-id
        in: header
        schema:
          type: string
          default: default
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ResponseBehaviourTag'
  /thunder/ctas:
    get:
      parameters:
      - name: behaviourTag
        in: query
        schema:
          type: string
      - name: createdBy
        in: query
        schema:
          type: string
      - name: name
        in: query
        schema:
          type: string
      - name: pageNumber
        in: query
        schema:
          type: integer
          format: int32
      - name: pageSize
        in: query
        schema:
          type: integer
          format: int32
      - name: searchName
        in: query
        schema:
          type: string
      - name: status
        in: query
        schema:
          type: string
      - name: tags
        in: query
        schema:
          type: string
      - name: teams
        in: query
        schema:
          type: string
      - name: x-tenant-id
        in: header
        schema:
          type: string
          default: default
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ResponseCTAListResponse'
    post:
      parameters:
      - name: user
        in: header
        schema:
          type: string
        required: true
      - name: x-tenant-id
        in: header
        schema:
          type: string
          default: default
      requestBody:
        content:
          '*/*':
            schema:
              $ref: '#/components/schemas/CTARequest'
        required: true
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ResponseLong'
  /thunder/ctas/{ctaId}:
    put:
      parameters:
      - name: ctaId
        in: path
        required: true
        schema:
          type: integer
          format: int64
      - name: user
        in: header
        schema:
          type: string
        required: true
      - name: x-tenant-id
        in: header
        schema:
          type: string
          default: default
      requestBody:
        content:
          '*/*':
            schema:
              $ref: '#/components/schemas/CTAUpdateRequest'
        required: true
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ResponseObject'
    get:
      parameters:
      - name: ctaId
        in: path
        required: true
        schema:
          type: integer
          format: int64
      - name: x-tenant-id
        in: header
        schema:
          type: string
          default: default
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ResponseCTA'
  /thunder/ctas/{id}/conclude:
    put:
      parameters:
      - name: id
        in: path
        required: true
        schema:
          type: integer
          format: int64
      - name: x-tenant-id
        in: header
        schema:
          type: string
          default: default
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ResponseObject'
  /thunder/ctas/{id}/live:
    put:
      parameters:
      - name: id
        in: path
        required: true
        schema:
          type: integer
          format: int64
      - name: x-tenant-id
        in: header
        schema:
          type: string
          default: default
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ResponseObject'
  /thunder/ctas/{id}/pause:
    put:
      parameters:
      - name: id
        in: path
        required: true
        schema:
          type: integer
          format: int64
      - name: x-tenant-id
        in: header
        schema:
          type: string
          default: default
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ResponseObject'
  /thunder/ctas/{id}/schedule:
    put:
      parameters:
      - name: id
        in: path
        required: true
        schema:
          type: integer
          format: int64
      - name: x-tenant-id
        in: header
        schema:
          type: string
          default: default
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ResponseObject'
  /thunder/ctas/{id}/terminate:
    put:
      parameters:
      - name: id
        in: path
        required: true
        schema:
          type: integer
          format: int64
      - name: x-tenant-id
        in: header
        schema:
          type: string
          default: default
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ResponseObject'
  /thunder/filters:
    get:
      parameters:
      - name: x-tenant-id
        in: header
        schema:
          type: string
          default: default
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ResponseFilterResponse'
  /thunder/nudge/preview:
    get:
      parameters:
      - name: id
        in: query
        schema:
          type: string
      - name: x-tenant-id
        in: header
        schema:
          type: string
          default: default
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ResponseNudgePreview'
    post:
      parameters:
      - name: x-tenant-id
        in: header
        schema:
          type: string
          default: default
      requestBody:
        content:
          '*/*':
            schema:
              $ref: '#/components/schemas/NudgePreview'
        required: true
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ResponseObject'
  /thunder/nudges:
    put:
      parameters:
      - name: x-tenant-id
        in: header
        schema:
          type: string
          default: default
      requestBody:
        content:
          '*/*':
            schema:
              $ref: '#/components/schemas/Nudge'
        required: true
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ResponseObject'
    post:
      parameters:
      - name: x-tenant-id
        in: header
        schema:
          type: string
          default: default
      requestBody:
        content:
          '*/*':
            schema:
              $ref: '#/components/schemas/Nudge'
        required: true
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ResponseObject'
info:
  title: Generated API
  version: '1.0'
  description: Thunder Admin API - Management endpoints for CTAs, Nudges, and Behaviour Tags
servers:
- url: http://localhost:8081
  description: Thunder Admin (Local)
- url: https://admin.thunder.example.com
  description: Production Admin
